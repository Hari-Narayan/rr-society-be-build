"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.validate=exports.validateFileUpload=void 0;const commonHelper_1=__importDefault(require("../helpers/commonHelper")),responseHelper_1=__importDefault(require("../helpers/responseHelper")),common_1=require("../lang/en/common"),validateFileUpload=(e,r,s=0)=>(t,o,a)=>{if(!t.files||!t.files[r])return responseHelper_1.default.error({res:o,code:400,message:`${r} is required`});const l=t.files[r],i=Array.isArray(l)?l:[l];if(i.length<s)return responseHelper_1.default.error({res:o,code:400,message:`At least ${s} file(s) are required for ${r}`});for(const r of i){const s=e.safeParse(r);if(!s.success){const e=s.error.flatten().fieldErrors,r=Object.entries(e).map((([e,r])=>({[e]:r||[]}))),t=Object.entries(e).flatMap((([e,r])=>(r||[]).map((r=>`${commonHelper_1.default.capitalizeFirstLetter(e)} is ${r.toLowerCase()}`))));return responseHelper_1.default.error({res:o,code:400,errors:r,error:"Validation failed",flatErrors:t,message:t[0]||common_1.SOMETHING_WENT_WRONG})}}a()};exports.validateFileUpload=validateFileUpload;const validate=e=>(r,s,t)=>{const o=e.safeParse(r.body);if(!o.success){const e=o.error.flatten().fieldErrors,r=Object.entries(e).map((([e,r])=>({[e]:r||[]}))),t=Object.entries(e).flatMap((([,e])=>(e||[]).map((e=>e))));return responseHelper_1.default.error({res:s,code:400,errors:r,error:"Validation failed",flatErrors:t,message:t[0]||common_1.SOMETHING_WENT_WRONG})}r.body=o.data,t()};exports.validate=validate;